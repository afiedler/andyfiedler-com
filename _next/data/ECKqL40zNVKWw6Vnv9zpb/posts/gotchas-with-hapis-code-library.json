{"pageProps":{"postData":{"id":"gotchas-with-hapis-code-library","contentHtml":"<p>Overall, I've had a good experience with HapiJS and Code, Hapi's assertion library. There was one gotcha with Code's <code>deep.equal</code> function. If you are comparing two objects that have identical non-function properties, but different function properties, <code>deep.equal</code> will fail. So, for example, if you compare a Hapi response to a Plain Old Javascript Object fixture, you will get an exception.</p>\n<p>The solution is to strip the non-function properties before comparing:</p>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// response - an object with some function properties</span>\n<span class=\"token comment\">// fixture - a Plain Old Javascript Object</span>\n<span class=\"token keyword\">var</span> responsePojo <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">parse</span><span class=\"token punctuation\">(</span><span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">stringify</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>responsePojo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">to</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">deep</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">equal</span><span class=\"token punctuation\">(</span>fixture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n","layout":"post","status":"publish","published":true,"title":"Gotchas with Hapi's Code Library","author":{"display_name":"afiedler","login":"afiedler","email":"andy@andyfiedler.com","url":""},"author_login":"afiedler","author_email":"andy@andyfiedler.com","wordpress_id":327,"wordpress_url":"http://andyfiedler.com/?p=327","date":"2015-07-22 10:06:32 -0400","date_gmt":"2015-07-22 14:06:32 -0400","categories":["Scrapbook"],"tags":["nodejs","hapi"]}},"__N_SSG":true}