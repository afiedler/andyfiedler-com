{"pageProps":{"postData":{"id":"export-a-heroku-postgres-schema","contentHtml":"<p>This is a quick script to export just the schema from a Heroku Postgres database. It exports the schema with no ownership information, so you can easily load it into a local database.</p>\n<div class=\"remark-highlight\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\">#!/usr/bin/env ruby</span>\n<span class=\"token keyword\">require</span> <span class=\"token string\">'uri'</span>\ndb <span class=\"token operator\">=</span> <span class=\"token constant\">URI</span><span class=\"token punctuation\">(</span>`heroku config<span class=\"token symbol\">:get</span> <span class=\"token constant\">DATABASE_URL</span>`<span class=\"token punctuation\">)</span>\nsystem<span class=\"token punctuation\">(</span><span class=\"token string\">\"export PGPASSWORD=<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>db<span class=\"token punctuation\">.</span>password<span class=\"token delimiter tag\">}</span></span>; \"</span> <span class=\"token operator\">+</span>\n       <span class=\"token string\">\"pg_dump --schema-only -h <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>db<span class=\"token punctuation\">.</span>host<span class=\"token delimiter tag\">}</span></span> -p <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>db<span class=\"token punctuation\">.</span>port<span class=\"token delimiter tag\">}</span></span> \"</span> <span class=\"token operator\">+</span>\n       <span class=\"token string\">\"-U <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>db<span class=\"token punctuation\">.</span>user<span class=\"token delimiter tag\">}</span></span> -d <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>db<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>gsub<span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token delimiter tag\">}</span></span> --no-owner -f schema.sql\"</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>Make sure you run this script from a folder within your app (with the Heroku git remote correctly set up). It will put the schema in schema.sql in the current working directory.</p>\n","layout":"post","status":"publish","published":true,"title":"Export a Heroku Postgres Schema","author":{"display_name":"afiedler","login":"afiedler","email":"andy@andyfiedler.com","url":""},"author_login":"afiedler","author_email":"andy@andyfiedler.com","wordpress_id":342,"wordpress_url":"http://andyfiedler.com/?p=342","date":"2015-09-10 13:58:45 -0400","date_gmt":"2015-09-10 17:58:45 -0400","categories":["Scrapbook"],"tags":["postgres","heroku"]}},"__N_SSG":true}