{"pageProps":{"postData":{"id":"google-analytics-with-angularjs-and-ui-router","contentHtml":"<p>I helped <a href=\"http://www.cleanslatedc.com/\">Clean Slate DC</a> add Google Analytics to their app last night at <a href=\"http://codefordc.org\">Code For DC</a> and realized others might not know how to do this. It's pretty simple, but you won't want to follow the directions on Google Analytics exactly. Instead, add this to your <code>index.html</code> or main page <code>&#x3C;head></code>, replacing your UA code with the UA code that Google gives you:</p>\n<div><pre><code><span>&#x3C;!-- Google Analytics --></span>\n<span><span><span>&#x3C;</span>script</span><span>></span></span><span><span>\n<span>(</span><span>function</span><span>(</span><span>i<span>,</span>s<span>,</span>o<span>,</span>g<span>,</span>r<span>,</span>a<span>,</span>m</span><span>)</span><span>{</span>i<span>[</span><span>'GoogleAnalyticsObject'</span><span>]</span><span>=</span>r<span>;</span>i<span>[</span>r<span>]</span><span>=</span>i<span>[</span>r<span>]</span><span>||</span><span>function</span><span>(</span><span>)</span><span>{</span>\n<span>(</span>i<span>[</span>r<span>]</span><span>.</span><span>q</span><span>=</span>i<span>[</span>r<span>]</span><span>.</span><span>q</span><span>||</span><span>[</span><span>]</span><span>)</span><span>.</span><span>push</span><span>(</span>arguments<span>)</span><span>}</span><span>,</span>i<span>[</span>r<span>]</span><span>.</span><span>l</span><span>=</span><span>1</span><span>*</span><span>new</span> <span>Date</span><span>(</span><span>)</span><span>;</span>a<span>=</span>s<span>.</span><span>createElement</span><span>(</span>o<span>)</span><span>,</span>\nm<span>=</span>s<span>.</span><span>getElementsByTagName</span><span>(</span>o<span>)</span><span>[</span><span>0</span><span>]</span><span>;</span>a<span>.</span><span>async</span><span>=</span><span>1</span><span>;</span>a<span>.</span><span>src</span><span>=</span>g<span>;</span>m<span>.</span><span>parentNode</span><span>.</span><span>insertBefore</span><span>(</span>a<span>,</span>m<span>)</span>\n<span>}</span><span>)</span><span>(</span><span>window</span><span>,</span><span>document</span><span>,</span><span>'script'</span><span>,</span><span>'//www.google-analytics.com/analytics.js'</span><span>,</span><span>'ga'</span><span>)</span><span>;</span>\n<span>ga</span><span>(</span><span>'create'</span><span>,</span> <span>'UA-XXXX-X'</span><span>,</span> <span>'auto'</span><span>)</span><span>;</span>\n</span></span><span><span><span>&#x3C;/</span>script</span><span>></span></span>\n<span>&#x3C;!-- End Google Analytics --></span>\n</code></pre></div>\n<p>Next, add a service to your Angular project:</p>\n<div><pre><code>angular<span>.</span><span>module</span><span>(</span><span>\"app\"</span><span>)</span><span>.</span><span>service</span><span>(</span><span>'Analytics'</span><span>,</span> <span>function</span><span>(</span><span>)</span> <span>{</span>\n\n  <span>this</span><span>.</span><span>recordPageview</span> <span>=</span> <span>function</span><span>(</span><span>url</span><span>)</span> <span>{</span>\n    <span>ga</span><span>(</span><span>'set'</span><span>,</span> <span>'page'</span><span>,</span> url<span>)</span><span>;</span>\n    <span>ga</span><span>(</span><span>'send'</span><span>,</span> <span>'pageview'</span><span>)</span><span>;</span>\n  <span>}</span><span>;</span>\n\n<span>}</span><span>)</span><span>;</span>\n</code></pre></div>\n<p>Finally, add a run block near where your app starts:</p>\n<div><pre><code>angular<span>.</span><span>module</span><span>(</span><span>\"app\"</span><span>)</span><span>.</span><span>run</span><span>(</span><span>function</span><span>(</span><span>$rootScope<span>,</span> $<span>location</span><span>,</span> <span>Analytics</span></span><span>)</span> <span>{</span>\n  $rootScope<span>.</span><span>$on</span><span>(</span><span>'$stateChangeSuccess'</span><span>,</span> <span>function</span><span>(</span><span>)</span> <span>{</span>\n    <span>Analytics</span><span>.</span><span>recordPageview</span><span>(</span>$<span>location</span><span>.</span><span>url</span><span>(</span><span>)</span><span>)</span><span>;</span>\n  <span>}</span><span>)</span><span>;</span>\n<span>}</span><span>)</span><span>;</span>\n</code></pre></div>\n<p>There you go!</p>\n","layout":"post","status":"publish","published":true,"title":"Google Analytics with AngularJS and UI-Router","author":{"display_name":"afiedler","login":"afiedler","email":"andy@andyfiedler.com","url":""},"author_login":"afiedler","author_email":"andy@andyfiedler.com","wordpress_id":337,"wordpress_url":"http://andyfiedler.com/?p=337","date":"2015-07-29 12:54:59 -0400","date_gmt":"2015-07-29 16:54:59 -0400","categories":["Scrapbook"],"tags":["angularjs","google-analytics"]}},"__N_SSG":true}