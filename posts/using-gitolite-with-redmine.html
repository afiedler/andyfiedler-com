<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Andy Fiedler&#x27;s Personal Site"/><title>Using Gitolite with Redmine</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/588d179d14f543de1f7e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/588d179d14f543de1f7e.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-8495f486508069a84016.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" as="script"/><link rel="preload" href="/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.b528922461d10cbe9bfe.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-2f6c726a4c5d3dfd1e8f.js" as="script"/><link rel="preload" href="/_next/static/chunks/0a3463f7b698f32fd7af40216f1292ceb318b3f7.39ce756e4870b72d4174.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-29dccdc32ec4574aab67.js" as="script"/></head><body><div id="__next"><div id="main"><div class="max-w-screen-md mx-auto px-4"><div class="flex items-center justify-between py-6 lg:py-10"><a href="/" class="flex items-center"><p class="font-body font-bold text-2xl text-primary dark:text-white">Andy Fiedler</p></a><div class="flex items-center lg:hidden"><svg width="24" height="15" xmlns="http://www.w3.org/2000/svg" class="fill-current text-primary dark:text-white"><g fill-rule="evenodd"><rect width="24" height="3" rx="1.5"></rect><rect x="8" y="6" width="16" height="3" rx="1.5"></rect><rect x="4" y="12" width="20" height="3" rx="1.5"></rect></g></svg></div><div class="hidden lg:block"><ul class="flex items-center"><li class="mr-6 relative group mb-1"><div class="absolute left-0 bottom-0 w-full transition-all h-0 group-hover:h-2 group-hover:bg-yellow opacity-75 z-20"></div><a href="/posts" class="font-body font-medium text-lg text-primary dark:text-white group-hover:text-green dark:group-hover:text-secondary px-2 z-30 block relative transition-colors">Posts</a></li><li><i class="bx text-3xl text-primary dark:text-white cursor-pointer"></i></li></ul></div><div class="bg-black bg-opacity-80 fixed inset-0 z-20 flex opacity-0 pointer-events-none transition-opacity lg:hidden "><div class="ml-auto bg-blue-600 w-2/3 md:w-1/3 p-4"><svg viewBox="0 0 20 20" width="24" height="24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-white absolute top-0 right-0 mt-4 mr-4"><path d="M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z"></path></svg><i class="absolute top-0 right-0 mt-4 mr-4"></i><ul class="flex flex-col mt-8"><li class=""><a href="/posts" class="font-body font-medium text-lg text-white px-2 block mb-3">Posts</a></li></ul></div></div></div></div><div class="max-w-screen-md mx-auto px-4"><div class="pt-16 lg:pt-20"><div class="border-b border-grey-lighter pb-8 sm:pb-12"><h2 class="font-body font-semibold text-primary dark:text-white text-3xl sm:text-4xl md:text-5xl block leading-tight">Using Gitolite with Redmine</h2><div class="flex items-center pt-5 sm:pt-8"><p class="font-body font-light text-primary dark:text-white pr-2">2012-05-14 11:09:38 -0400</p></div></div><article class="border-b border-grey-lighter py-8 sm:py-12 prose prose dark:prose-dark max-w-none"><p>I use Gitolite to self-host multiple git projects and Redmine for time-tracking and project management. Redmine has a cool feature where it can integrate with source control management systems, but getting it to work with Gitolite was a bit of a challenge. Here's how I did it.</p>
<p>First, create a new repository in Gitolite. You're going to want to mirror a read-only version somewhere for Redmine to access. Then, we'll keep them synced using a post-receive hook in Git. After you create your new Gitolite repo, login to your server and go to a folder where you'll keep a mirror for Redmine. In this example, I'll use <code>&#47;var&#47;gitolite-mirrors&#47;<&#47;code>. In that folder, type this to create a mirror of your Gitolite repo and, critically, make git change the permissions of new files to 0644 (which gives read access to all users). Note that # means run as root.</p>
<pre class="lang:default highlight:0 decode:true"># git clone --mirror &#47;home&#47;git&#47;repositories&#47;my-new-repo.git<br />
# cd my-new-repo.git<br />
# git config --add core.sharedRepository 0644<&#47;pre><br />
Now, change the permissions so that the git user (the user that Gitolite runs as) owns this folder.</p>
<pre class="lang:default highlight:0 decode:true"># chown -R git:git ..&#47;my-new-repo.git<&#47;pre><br />
Finally, we'll add a post-receive hook to the Gitolite repo. Go to <code>&#47;home&#47;git&#47;repositories&#47;my-new-repo.git&#47;hooks<&#47;code>. Add a new file called <code>post-receive<&#47;code>, and enter this into the file:</p>
<pre class="lang:default highlight:0 decode:true">#!&#47;bin&#47;sh<br />
&#47;usr&#47;bin&#47;git push --mirror &#47;var&#47;gitolite-mirrors&#47;my-new-repo.git<&#47;pre><br />
Then, you'll want to change the ownership and permissions on that.</p>
<pre class="lang:default highlight:0 decode:true crayon-selected"># chown git:git post-receive<br />
# chmod 700 post-receive<&#47;pre><br />
In Redmine, go to your project you want to associate with this repo. Click the Settings, then Repository tabs. Choose Git as your SCM. In this example, you'd enter <code>&#47;var&#47;gitolite-mirrots&#47;my-new-repo.git<&#47;code> as your repository path. Click "Save".</p>
<p>Now, click the Repository tab on the top tab bar. You may get a 404 error at this point. That is because you need to push a master branch to this repository (it is empty right now). Push a few files to the repo and check again.</p>
<p>If it is still not working, you can log in to your server and navigate to the mirror location (<code>&#47;var&#47;gitolite-mirrors&#47;my-new-repo.git<&#47;code>). Switch users to the user your Redmine process is running as (probably www-data or something similar). Redmine is running <code>git log master<&#47;code> to get the changes from your repo to display on the webpage. Try running that command and see if you get any errors, and debug from there.</p>
</article></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"using-gitolite-with-redmine","contentHtml":"\u003cp\u003eI use Gitolite to self-host multiple git projects and Redmine for time-tracking and project management. Redmine has a cool feature where it can integrate with source control management systems, but getting it to work with Gitolite was a bit of a challenge. Here's how I did it.\u003c/p\u003e\n\u003cp\u003eFirst, create a new repository in Gitolite. You're going to want to mirror a read-only version somewhere for Redmine to access. Then, we'll keep them synced using a post-receive hook in Git. After you create your new Gitolite repo, login to your server and go to a folder where you'll keep a mirror for Redmine. In this example, I'll use \u003ccode\u003e\u0026#47;var\u0026#47;gitolite-mirrors\u0026#47;\u003c\u0026#47;code\u003e. In that folder, type this to create a mirror of your Gitolite repo and, critically, make git change the permissions of new files to 0644 (which gives read access to all users). Note that # means run as root.\u003c/p\u003e\n\u003cpre class=\"lang:default highlight:0 decode:true\"\u003e# git clone --mirror \u0026#47;home\u0026#47;git\u0026#47;repositories\u0026#47;my-new-repo.git\u003cbr /\u003e\n# cd my-new-repo.git\u003cbr /\u003e\n# git config --add core.sharedRepository 0644\u003c\u0026#47;pre\u003e\u003cbr /\u003e\nNow, change the permissions so that the git user (the user that Gitolite runs as) owns this folder.\u003c/p\u003e\n\u003cpre class=\"lang:default highlight:0 decode:true\"\u003e# chown -R git:git ..\u0026#47;my-new-repo.git\u003c\u0026#47;pre\u003e\u003cbr /\u003e\nFinally, we'll add a post-receive hook to the Gitolite repo. Go to \u003ccode\u003e\u0026#47;home\u0026#47;git\u0026#47;repositories\u0026#47;my-new-repo.git\u0026#47;hooks\u003c\u0026#47;code\u003e. Add a new file called \u003ccode\u003epost-receive\u003c\u0026#47;code\u003e, and enter this into the file:\u003c/p\u003e\n\u003cpre class=\"lang:default highlight:0 decode:true\"\u003e#!\u0026#47;bin\u0026#47;sh\u003cbr /\u003e\n\u0026#47;usr\u0026#47;bin\u0026#47;git push --mirror \u0026#47;var\u0026#47;gitolite-mirrors\u0026#47;my-new-repo.git\u003c\u0026#47;pre\u003e\u003cbr /\u003e\nThen, you'll want to change the ownership and permissions on that.\u003c/p\u003e\n\u003cpre class=\"lang:default highlight:0 decode:true crayon-selected\"\u003e# chown git:git post-receive\u003cbr /\u003e\n# chmod 700 post-receive\u003c\u0026#47;pre\u003e\u003cbr /\u003e\nIn Redmine, go to your project you want to associate with this repo. Click the Settings, then Repository tabs. Choose Git as your SCM. In this example, you'd enter \u003ccode\u003e\u0026#47;var\u0026#47;gitolite-mirrots\u0026#47;my-new-repo.git\u003c\u0026#47;code\u003e as your repository path. Click \"Save\".\u003c/p\u003e\n\u003cp\u003eNow, click the Repository tab on the top tab bar. You may get a 404 error at this point. That is because you need to push a master branch to this repository (it is empty right now). Push a few files to the repo and check again.\u003c/p\u003e\n\u003cp\u003eIf it is still not working, you can log in to your server and navigate to the mirror location (\u003ccode\u003e\u0026#47;var\u0026#47;gitolite-mirrors\u0026#47;my-new-repo.git\u003c\u0026#47;code\u003e). Switch users to the user your Redmine process is running as (probably www-data or something similar). Redmine is running \u003ccode\u003egit log master\u003c\u0026#47;code\u003e to get the changes from your repo to display on the webpage. Try running that command and see if you get any errors, and debug from there.\u003c/p\u003e\n","layout":"post","status":"publish","published":true,"title":"Using Gitolite with Redmine","author":{"display_name":"afiedler","login":"afiedler","email":"andy@andyfiedler.com","url":""},"author_login":"afiedler","author_email":"andy@andyfiedler.com","wordpress_id":40,"wordpress_url":"http://andyfiedler.com/?p=40","date":"2012-05-14 11:09:38 -0400","date_gmt":"2012-05-14 15:09:38 -0400","categories":["Tech Notes"],"tags":[]}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"using-gitolite-with-redmine"},"buildId":"au-zTTOac9_rvw04kgZaC","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-144e5fa6fafab6397d9c.js"></script><script src="/_next/static/chunks/main-8495f486508069a84016.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" async=""></script><script src="/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.b528922461d10cbe9bfe.js" async=""></script><script src="/_next/static/chunks/pages/_app-2f6c726a4c5d3dfd1e8f.js" async=""></script><script src="/_next/static/chunks/0a3463f7b698f32fd7af40216f1292ceb318b3f7.39ce756e4870b72d4174.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-29dccdc32ec4574aab67.js" async=""></script><script src="/_next/static/au-zTTOac9_rvw04kgZaC/_buildManifest.js" async=""></script><script src="/_next/static/au-zTTOac9_rvw04kgZaC/_ssgManifest.js" async=""></script></body></html>