<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Andy Fiedler&#x27;s Personal Site"/><title>Using TSDB to store U.S. Equities data from TickData</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/588d179d14f543de1f7e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/588d179d14f543de1f7e.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-8495f486508069a84016.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" as="script"/><link rel="preload" href="/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.b528922461d10cbe9bfe.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-2f6c726a4c5d3dfd1e8f.js" as="script"/><link rel="preload" href="/_next/static/chunks/0a3463f7b698f32fd7af40216f1292ceb318b3f7.39ce756e4870b72d4174.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-29dccdc32ec4574aab67.js" as="script"/></head><body><div id="__next"><div id="main"><div class="max-w-screen-md mx-auto px-4"><div class="flex items-center justify-between py-6 lg:py-10"><a href="/" class="flex items-center"><p class="font-body font-bold text-2xl text-primary dark:text-white">Andy Fiedler</p></a><div class="flex items-center lg:hidden"><svg width="24" height="15" xmlns="http://www.w3.org/2000/svg" class="fill-current text-primary dark:text-white"><g fill-rule="evenodd"><rect width="24" height="3" rx="1.5"></rect><rect x="8" y="6" width="16" height="3" rx="1.5"></rect><rect x="4" y="12" width="20" height="3" rx="1.5"></rect></g></svg></div><div class="hidden lg:block"><ul class="flex items-center"><li class="mr-6 relative group mb-1"><div class="absolute left-0 bottom-0 w-full transition-all h-0 group-hover:h-2 group-hover:bg-yellow opacity-75 z-20"></div><a href="/posts" class="font-body font-medium text-lg text-primary dark:text-white group-hover:text-green dark:group-hover:text-secondary px-2 z-30 block relative transition-colors">Posts</a></li><li><i class="bx text-3xl text-primary dark:text-white cursor-pointer"></i></li></ul></div><div class="bg-black bg-opacity-80 fixed inset-0 z-20 flex opacity-0 pointer-events-none transition-opacity lg:hidden "><div class="ml-auto bg-blue-600 w-2/3 md:w-1/3 p-4"><svg viewBox="0 0 20 20" width="24" height="24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-white absolute top-0 right-0 mt-4 mr-4"><path d="M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z"></path></svg><i class="absolute top-0 right-0 mt-4 mr-4"></i><ul class="flex flex-col mt-8"><li class=""><a href="/posts" class="font-body font-medium text-lg text-white px-2 block mb-3">Posts</a></li></ul></div></div></div></div><div class="max-w-screen-md mx-auto px-4"><div class="pt-16 lg:pt-20"><div class="border-b border-grey-lighter pb-8 sm:pb-12"><h2 class="font-body font-semibold text-primary dark:text-white text-3xl sm:text-4xl md:text-5xl block leading-tight">Using TSDB to store U.S. Equities data from TickData</h2><div class="flex items-center pt-5 sm:pt-8"><p class="font-body font-light text-primary dark:text-white pr-2">2012-07-06 17:18:20 -0400</p></div></div><article class="border-b border-grey-lighter py-8 sm:py-12 prose prose dark:prose-dark max-w-none"><p>In this article, I'll show you how to use my&nbsp;<a title="Time Series Database" href="http:&#47;&#47;andyfiedler.com&#47;projects&#47;time-series-database&#47;">Time Series Database<&#47;a> to import some sample U.S. equities data from <a href="http:&#47;&#47;www.tickdata.com">TickData<&#47;a>, a data provider of high-frequency historical financial data. First, get the <a href="http:&#47;&#47;www.tickdata.com&#47;downloads&#47;SampleEquityData_US.zip">sample data<&#47;a> and unzip it on your computer. Look in the Quotes folder for a file called GLP_27667.asc. This is file has quotes for Global Partners LP, a petroleum company. If you are running on Mac OS X or Linux, you can use the <code>head<&#47;code> command to see the first few lines, which in my download look like this:</p>
<pre class="lang:default highlight:0 decode:true">11&#47;01&#47;2011,04:00:00.301,P,14.5,21.36,5,1,R,,175,P,P,1,2,,C<br />
11&#47;01&#47;2011,04:56:38.930,P,14.5,21.36,5,2,R,,18491,P,P,1,2,,C<br />
11&#47;01&#47;2011,06:02:00.115,M,0,0,0,0,R,,40307,M,M,0,2,,C<br />
11&#47;01&#47;2011,07:15:35.501,P,16.67,21.36,15,2,R,,73573,P,P,1,2,,C<br />
11&#47;01&#47;2011,07:28:41.053,P,18.4,21.36,10,2,R,,80351,P,P,1,2,,C<br />
11&#47;01&#47;2011,07:35:03.401,T,15.18,0,1,0,R,,88691,T,T,0,2,,C<br />
11&#47;01&#47;2011,07:35:03.402,T,15.18,25.1,1,1,R,,88692,T,T,0,2,,C<br />
11&#47;01&#47;2011,07:50:24.960,T,15.18,21.22,1,1,R,,100945,T,T,6,2,,C<br />
11&#47;01&#47;2011,07:50:29.064,P,14.5,21.36,5,2,R,,100980,P,P,6,2,,C<br />
11&#47;01&#47;2011,07:50:29.072,T,0,21.22,0,1,R,,100981,T,T,6,2,,C<&#47;pre><br />
If you look on TickData's website, you can find a <a title="U.S. Equities TickData Format Definition" href="http:&#47;&#47;www.tickdata.com&#47;pdf&#47;TickData_File_Format_Overview_US_Equities.pdf">document describing the format<&#47;a> of these files in detail, but for this example, we're only going to look at the first 7 fields.</p>
<ul>
<li>Date (MM&#47;DD&#47;YYYY)<&#47;li>
<li>Time<&#47;li>
<li>Exchange indicator (P means ARCA, M means Chicago, T means NASD)<&#47;li>
<li>Bid Price<&#47;li>
<li>Ask Price<&#47;li>
<li>Bid Amount (100 share lots)<&#47;li>
<li>Ask Amount (100 share lots)<&#47;li><br />
<&#47;ul><br />
Let's create a new TSDB file to store this data. To do this, use the tsdbcreate command.</p>
<pre class="lang:sh decode:true">tsdbcreate glp.tsdb quotes char exchange double bid_price double ask_price int32 bid_size int32 ask_size<&#47;pre><br />
This command is creating a new tsdb database called glp.tsdb with a series called "quotes". That series has 5 columns: exchange (a character), bid_price (floating point double), ask_price (floating point double), bid_size and ask_size (both 32-bit integers).</p>
<p>You can add more than one series to a TSDB file. If you were to call the tsdbcreate command and glp.tsdb already existed, then it would add another series to the file.</p>
<p>Now that you have an empty TSDB file, we'll create some import instructions and import the data. TSDB has a program called TSDB import that uses an XML file to describe how to parse the delimited data in a file like a CSV file and append it to the end of a time series.&nbsp; Whenever you import data, you are always appending it to the end of a time series.<strong>&nbsp;<&#47;strong>You can import from more than one file into one series in a TSDB file, but you need to start with the earliest file. You also must make sure each of the files you import are in chronological order from oldest timestamp to newest (repeated timestamps are okay).</p>
<p>Here's an example XML file that shows how you could import the TickData quotes files.</p>
<pre class="lang:xml"><?xml version="1.0" encoding="UTF-8" ?><br />
   <dataimport><br />
      <delimparser field_delim=","><br />
         <fieldparser name="_TDSB_timestamp" type="timestamp"<br />
            tokens="0,1" format_string="%m&#47;%d&#47;%Y %H:%M:%S%F" &#47;><br />
         <fieldparser name="exchange" type="char" tokens="2" &#47;><br />
         <fieldparser name="bid_price" type="double" tokens="3" &#47;><br />
         <fieldparser name="ask_price" type="double" tokens="4" &#47;><br />
         <fieldparser name="bid_amount" type="int32" tokens="5" &#47;><br />
         <fieldparser name="ask_amount" type="int32" tokens="6" &#47;><br />
      <&#47;delimparser><br />
   <&#47;dataimport><&#47;pre><br />
The XML import tells the tsdbimport command how to map the comma-separated values in each line into columns in the database. Notice in the timestamp <code>fieldparser<&#47;code> block, we specify to use tokens 0 and 1 to make the timestamp. This tells the parser to join tokens zero and one with a space and then to parse the combined string as a timestamp.</p>
<p>You can save that XML as a text file called "instructions.xml" and then import the&nbsp;GLP_27667.asc file like this:</p>
<pre class="lang:sh">tsdbimport instructions.xml GLP_27667.asc glp.tsdb quotes<&#47;pre><br />
After you run this command, you'll have the complete GLP time series imported. Now, you can access this data quickly via either the R or MATLAB TSDB bindings. Stay tuned for a article on how to do that within the next few days.</p>
</article></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"using-tsdb-to-store-u-s-equities-data-from-tickdata","contentHtml":"\u003cp\u003eIn this article, I'll show you how to use my\u0026nbsp;\u003ca title=\"Time Series Database\" href=\"http:\u0026#47;\u0026#47;andyfiedler.com\u0026#47;projects\u0026#47;time-series-database\u0026#47;\"\u003eTime Series Database\u003c\u0026#47;a\u003e to import some sample U.S. equities data from \u003ca href=\"http:\u0026#47;\u0026#47;www.tickdata.com\"\u003eTickData\u003c\u0026#47;a\u003e, a data provider of high-frequency historical financial data. First, get the \u003ca href=\"http:\u0026#47;\u0026#47;www.tickdata.com\u0026#47;downloads\u0026#47;SampleEquityData_US.zip\"\u003esample data\u003c\u0026#47;a\u003e and unzip it on your computer. Look in the Quotes folder for a file called GLP_27667.asc. This is file has quotes for Global Partners LP, a petroleum company. If you are running on Mac OS X or Linux, you can use the \u003ccode\u003ehead\u003c\u0026#47;code\u003e command to see the first few lines, which in my download look like this:\u003c/p\u003e\n\u003cpre class=\"lang:default highlight:0 decode:true\"\u003e11\u0026#47;01\u0026#47;2011,04:00:00.301,P,14.5,21.36,5,1,R,,175,P,P,1,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,04:56:38.930,P,14.5,21.36,5,2,R,,18491,P,P,1,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,06:02:00.115,M,0,0,0,0,R,,40307,M,M,0,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,07:15:35.501,P,16.67,21.36,15,2,R,,73573,P,P,1,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,07:28:41.053,P,18.4,21.36,10,2,R,,80351,P,P,1,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,07:35:03.401,T,15.18,0,1,0,R,,88691,T,T,0,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,07:35:03.402,T,15.18,25.1,1,1,R,,88692,T,T,0,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,07:50:24.960,T,15.18,21.22,1,1,R,,100945,T,T,6,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,07:50:29.064,P,14.5,21.36,5,2,R,,100980,P,P,6,2,,C\u003cbr /\u003e\n11\u0026#47;01\u0026#47;2011,07:50:29.072,T,0,21.22,0,1,R,,100981,T,T,6,2,,C\u003c\u0026#47;pre\u003e\u003cbr /\u003e\nIf you look on TickData's website, you can find a \u003ca title=\"U.S. Equities TickData Format Definition\" href=\"http:\u0026#47;\u0026#47;www.tickdata.com\u0026#47;pdf\u0026#47;TickData_File_Format_Overview_US_Equities.pdf\"\u003edocument describing the format\u003c\u0026#47;a\u003e of these files in detail, but for this example, we're only going to look at the first 7 fields.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDate (MM\u0026#47;DD\u0026#47;YYYY)\u003c\u0026#47;li\u003e\n\u003cli\u003eTime\u003c\u0026#47;li\u003e\n\u003cli\u003eExchange indicator (P means ARCA, M means Chicago, T means NASD)\u003c\u0026#47;li\u003e\n\u003cli\u003eBid Price\u003c\u0026#47;li\u003e\n\u003cli\u003eAsk Price\u003c\u0026#47;li\u003e\n\u003cli\u003eBid Amount (100 share lots)\u003c\u0026#47;li\u003e\n\u003cli\u003eAsk Amount (100 share lots)\u003c\u0026#47;li\u003e\u003cbr /\u003e\n\u003c\u0026#47;ul\u003e\u003cbr /\u003e\nLet's create a new TSDB file to store this data. To do this, use the tsdbcreate command.\u003c/p\u003e\n\u003cpre class=\"lang:sh decode:true\"\u003etsdbcreate glp.tsdb quotes char exchange double bid_price double ask_price int32 bid_size int32 ask_size\u003c\u0026#47;pre\u003e\u003cbr /\u003e\nThis command is creating a new tsdb database called glp.tsdb with a series called \"quotes\". That series has 5 columns: exchange (a character), bid_price (floating point double), ask_price (floating point double), bid_size and ask_size (both 32-bit integers).\u003c/p\u003e\n\u003cp\u003eYou can add more than one series to a TSDB file. If you were to call the tsdbcreate command and glp.tsdb already existed, then it would add another series to the file.\u003c/p\u003e\n\u003cp\u003eNow that you have an empty TSDB file, we'll create some import instructions and import the data. TSDB has a program called TSDB import that uses an XML file to describe how to parse the delimited data in a file like a CSV file and append it to the end of a time series.\u0026nbsp; Whenever you import data, you are always appending it to the end of a time series.\u003cstrong\u003e\u0026nbsp;\u003c\u0026#47;strong\u003eYou can import from more than one file into one series in a TSDB file, but you need to start with the earliest file. You also must make sure each of the files you import are in chronological order from oldest timestamp to newest (repeated timestamps are okay).\u003c/p\u003e\n\u003cp\u003eHere's an example XML file that shows how you could import the TickData quotes files.\u003c/p\u003e\n\u003cpre class=\"lang:xml\"\u003e\u003c?xml version=\"1.0\" encoding=\"UTF-8\" ?\u003e\u003cbr /\u003e\n   \u003cdataimport\u003e\u003cbr /\u003e\n      \u003cdelimparser field_delim=\",\"\u003e\u003cbr /\u003e\n         \u003cfieldparser name=\"_TDSB_timestamp\" type=\"timestamp\"\u003cbr /\u003e\n            tokens=\"0,1\" format_string=\"%m\u0026#47;%d\u0026#47;%Y %H:%M:%S%F\" \u0026#47;\u003e\u003cbr /\u003e\n         \u003cfieldparser name=\"exchange\" type=\"char\" tokens=\"2\" \u0026#47;\u003e\u003cbr /\u003e\n         \u003cfieldparser name=\"bid_price\" type=\"double\" tokens=\"3\" \u0026#47;\u003e\u003cbr /\u003e\n         \u003cfieldparser name=\"ask_price\" type=\"double\" tokens=\"4\" \u0026#47;\u003e\u003cbr /\u003e\n         \u003cfieldparser name=\"bid_amount\" type=\"int32\" tokens=\"5\" \u0026#47;\u003e\u003cbr /\u003e\n         \u003cfieldparser name=\"ask_amount\" type=\"int32\" tokens=\"6\" \u0026#47;\u003e\u003cbr /\u003e\n      \u003c\u0026#47;delimparser\u003e\u003cbr /\u003e\n   \u003c\u0026#47;dataimport\u003e\u003c\u0026#47;pre\u003e\u003cbr /\u003e\nThe XML import tells the tsdbimport command how to map the comma-separated values in each line into columns in the database. Notice in the timestamp \u003ccode\u003efieldparser\u003c\u0026#47;code\u003e block, we specify to use tokens 0 and 1 to make the timestamp. This tells the parser to join tokens zero and one with a space and then to parse the combined string as a timestamp.\u003c/p\u003e\n\u003cp\u003eYou can save that XML as a text file called \"instructions.xml\" and then import the\u0026nbsp;GLP_27667.asc file like this:\u003c/p\u003e\n\u003cpre class=\"lang:sh\"\u003etsdbimport instructions.xml GLP_27667.asc glp.tsdb quotes\u003c\u0026#47;pre\u003e\u003cbr /\u003e\nAfter you run this command, you'll have the complete GLP time series imported. Now, you can access this data quickly via either the R or MATLAB TSDB bindings. Stay tuned for a article on how to do that within the next few days.\u003c/p\u003e\n","layout":"post","status":"publish","published":true,"title":"Using TSDB to store U.S. Equities data from TickData","author":{"display_name":"afiedler","login":"afiedler","email":"andy@andyfiedler.com","url":""},"author_login":"afiedler","author_email":"andy@andyfiedler.com","wordpress_id":85,"wordpress_url":"http://andyfiedler.com/?p=85","date":"2012-07-06 17:18:20 -0400","date_gmt":"2012-07-06 21:18:20 -0400","categories":["Tech Notes"],"tags":[]}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"using-tsdb-to-store-u-s-equities-data-from-tickdata"},"buildId":"kin1HMdhXCenXl5fEijbK","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-144e5fa6fafab6397d9c.js"></script><script src="/_next/static/chunks/main-8495f486508069a84016.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" async=""></script><script src="/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.b528922461d10cbe9bfe.js" async=""></script><script src="/_next/static/chunks/pages/_app-2f6c726a4c5d3dfd1e8f.js" async=""></script><script src="/_next/static/chunks/0a3463f7b698f32fd7af40216f1292ceb318b3f7.39ce756e4870b72d4174.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-29dccdc32ec4574aab67.js" async=""></script><script src="/_next/static/kin1HMdhXCenXl5fEijbK/_buildManifest.js" async=""></script><script src="/_next/static/kin1HMdhXCenXl5fEijbK/_ssgManifest.js" async=""></script></body></html>